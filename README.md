---
title: 仿Numerical计算器
date: 2017-02-24 20:47:44
tags:
---
![Simple Caculator](http://ob9hppsg4.bkt.clouddn.com/Simple%20Caculator.gif)

## Simple Caculator  
模仿Numerical的简易计算器，额外添加了倒数，反号，开根功能，并支持自定义背景色。  
清除，除号，减号，括号有长按效果，分别为清除全部，倒数，反号，清除多余括号。结果区域左／右滑动为浏览上一步／下一步，上滑为浏览历史计算式，下滑为使用该结果。长按可以复制结果/粘贴数字。  
 
### details
计算的基本思路是根据用户输入的表达式，去掉多余的括号&尾部无用的符号得到格式化后的表达式，再提取数字与运算符进入计算数组，之后遍历该数组，根据优先级依次计算子表达式，用局部结果替换子表达式，直至数组计算完毕。  
同时根据用户输入表达式判定Button的禁用与否，例如最后一位是÷，其他符号就需要禁用。  
每次长按清除，或下滑屏幕使用结果时，会将上一个表达式储存至历史记录。  
为了支持根号类运算，数据类型使用Long Double，在输出位可保证结果精度。有一个小问题，格式化输出结果时，约等于的判定是根据四舍五入后末尾四位是否为0，在类似于1/99999999999的算式时会判定为除尽。经过多次测试，其他可能的Bug已基本排除。  

### added
Simple Caculator的计算核心很早就完成了，那时我对UI层级并不清楚，主界面的Layout是手动计算的，后期添加的设置界面才使用了AutoLayout。顺便添加了以前研究的HSB色彩变化，用于自定义背景颜色。  
##### 下载地址  
https://github.com/wutau/Simple-Caculator
